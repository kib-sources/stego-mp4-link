# <h1 align = "center">Вкрапление ссылки в файл *.m4a

## <p align = "center">Схема вкрапления ссылки в файл *.m4a

![general](https://user-images.githubusercontent.com/59966999/230737946-88667ca5-14d4-4438-8e1c-94576dad3140.png)



## <p align = "center">Схема преобразования пароля в ключ

![password to key](https://user-images.githubusercontent.com/59966999/230738006-980c35d8-f4e1-4d66-9e98-b0b3077e0f3d.png)

Критерии пароля:
1) Использование символов исключительно из таблицы **ASCII**
2) Длина пароля больше 9 символов

Применяется алгоритм Password-Based Key Derivation Function (**PBKDF2**), использующий алгоритм хеширования **SHA-512**. 
В результате получаем ключ из введённого пароля.

## <p align = "center">Схема шифрования сообщения

![encypt_message](https://user-images.githubusercontent.com/59966999/230738033-f9823780-2221-4196-86a9-19cb22330630.png)


В сообщении должны находиться символы исключительно из таблицы **ASCII**.

Для шифрования сообщения используем симметричный алгоритм блочного шифрования **AES** и кодировку **Base64**. Ключ получаем из прошлого шага. 
На выходе получаем зашифрованное сообщение.

## <p align = "center">Схема использования одноразового блокнота

![safenote_co](https://user-images.githubusercontent.com/59966999/230738048-0a75bd69-ed29-4d6e-8ab1-7e82aa4a3237.png)


Используем сервис **safenote.co**. Через **Selenium WebDriver** вставляем зашифрованное ранее сообщение в сервис. В результате
получаем ссылку, которую можно использовать _один раз_.

## <p align = "center">Схема использования сервиса коротких ссылок

![goo_su](https://user-images.githubusercontent.com/59966999/230738058-3632aacd-ab33-4312-a493-1faeead9fb2f.png)



Используем сервис **goo.su**. Для его использования необходимо получить индивидуальный **API-токен** (https://goo.su/api-doc) и вставить его в файл **.env** 
(пример формата представлен в файле **.env.example**). В результате получаем короткую ссылку, с которой дальше работаем.
# <p align = "center">Схема шифрования короткой ссылки и преобразования её в нибблы

![encrypt-link](https://user-images.githubusercontent.com/59966999/230738084-d4a46e3d-0cc5-4db1-a3bc-733841d289a8.png)

Применяется шифр Вернама для шифрования короткой ссылки. После шифрования преобразуем зашифрованную ссылку 
в **нибблы** (полубайты) с добавлением размера в начало (для возможности дальнейшего чтения из файла). В результате 
получаем список hex-символов.

# <p align = "center">Схема чтения метаданных, внедрение в неё списка нибблов
![readMD drawio](https://user-images.githubusercontent.com/59966999/230738143-ce9905af-55e1-44c7-b0d5-befd90d43872.png)


Считываются метаданные из файла *.m4a, внедряем в её чанки (**mvhd**, **tkhd**) информацию. На выходе получаем
новые метаданные *.m4a файла.


# <p align = "center">Схема записи новых метаданных в файл *.m4a

![write](https://user-images.githubusercontent.com/59966999/230738150-25c7ca9b-f198-4d11-918a-67e8991d5d20.png)

Подменяем старые метаданные на новые, записываем в файл *stego.m4a
___
<p align = "center">В результате имеем файл формата m4a, который содержит зашифрованную ссылку.
