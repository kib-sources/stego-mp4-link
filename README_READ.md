<h1 align="center">Схема считывания сообщения с файла (read).</h1>

![general](https://user-images.githubusercontent.com/59966999/230739535-80d8b67d-faa8-44df-ab06-d6f6cd7285b1.png)


<h2 align="center">Схема 1</h2>
![password](https://user-images.githubusercontent.com/59966999/230739529-4f0cbd71-8bb8-449b-af8f-d36ca8328a8c.png)

После того как мы вводим пароль, мы используем его как два ключа. Первый ключ для расшифрования ссылки при помощи шифра вернама ***link_key***,
второй в свою очередь предназначен для дешифровки хэшированного сообщения, ***message_key***.


<h2 align="center">Схема 2</h2>
![Metadata](https://user-images.githubusercontent.com/59966999/230739539-88f5ebdc-1539-41c4-8152-b98a997cf32f.png)

Мы считываем файл с зашифрованным сообщением, и находим в нём специальный чанк ***moov*** (метаданные), в котором находится сообщение.

<h2 align="center">Схема 3</h2>
![Nibbles](https://user-images.githubusercontent.com/59966999/230739544-08717aaa-4169-41ec-97af-0f72c1ae146f.png)

После считывания данного чанка мы перебираем его до подчанков, в которых и находится сообщение. В каждом чанке находится максимум по 2 символа из ссылки. Размер ссылки от 4-7, поэтому в первом подчанке первым символом мы храним размер ссылки.

- Чанк mvhd:
  - create-date - считываем первые 2 симвова и определяем размер
  - modify-date - считываем вторые 2 символа

- Чанк tkhd
    - track create-date - в третьем чанке может храниться минимум 1 символ. Считываем его в любом случае
    - track modify-date - в четвертом чанке может не быть символов. Чтобы корректно считать ссылку мы проверяем первый символ который является размером ссылки. В случае если цифра больше 6, тогда мы считываем символы в данном чанке, иначе его не открываем.

Собираем сообщение и при помощи словарей(***nibble_ret***) получаем список hex-элементов.

<h2 align="center">Схема 4</h2>
![decrypt_link](https://user-images.githubusercontent.com/59966999/230739547-7ef736ad-99ae-4b95-b464-d16ca13dddd8.png)

После получения списка hex элементов мы при помощи функции ***ex***  переводим список в зашифрованную ссылку. Затем при помощи **link_key** расшифровываем её и получаем готовую ссылку формата ***goo.su/(link)***.

<h2 align="center">Схема 5</h2>
![decrypt_message](https://user-images.githubusercontent.com/59966999/230739558-c76ae0bd-843b-44d7-8f0d-067d8234cb25.png)

После получения ссылки формата ***goo.su/(link)***, мы переходим по ней на сервис одноразовых сообщений, в которой считываем зашифрованное послание. При помощи **message_key** мы расшифровываем послание и читаем.

### Внимание прочитать один и тот же файл дважды невозможно. Сообщение является одноразовым.